name: Code Quality

on:
  pull_request:
    paths-ignore:
      - 'docs/**'
  push:
    branches: [ master ]
    paths-ignore:
      - 'docs/**'
      -


jobs:
  pre-commit:
    name: Linting
    runs-on: ubuntu-22.04
    steps:
      - uses: actions/checkout@v3
#      - uses: actions/setup-python@v2
#      - uses: pre-commit/action@v2.0.0

      - name: Read changelog config
        id: read-config
        run: |
          CONTENT=$(cat ./.github/changelog-config.json)
          echo "CONTENT<<EOF" >> $GITHUB_OUTPUT
          echo "$CONTENT" >> $GITHUB_OUTPUT
          echo "EOF" >> $GITHUB_OUTPUT
        shell: bash

      - name: Generate Changelog
        id: generate-release-changelog
        uses: heinrichreimer/github-changelog-generator-action@v2.2
        with:
          token: "${{ secrets.GITHUB_TOKEN }}"
          sinceTag: "${{ steps.release-tag.outputs.oldTag }}"
          output: "changes.md"
          stripGeneratorNotice: "true"
          issues: "true"
          unreleased: "true"
          pullRequests: "false"
          compareLink: "true"
          issuesWoLabels: "false"
          futureRelease: "${{ steps.release-tag.outputs.tag }}"
          issuesLabel: "**Miscellaneous:**"
          httpCache: "true"
          verbose: "true"
          addSections: |
            ${{ steps.read-config.outputs.content }}
